language: go
go: 1.15.x
services:
- docker
sudo: required
env:
  global:
    - secure: jR66ZoQNmKo01EeTth95e7oTtWfDBSGhKeEwJ8S2u3zj+r9Nk/g3A1hXLNGzybSdhBg8m+nXkJFO3PEHqAQnDoQzFUsT/WaK6hZ2Vib7QgJ3B4P7vNi7AwO9T+lvmvCwY9bDC2pjh5WD6fCOcrmiojX2nkFNh9hwedF0xTZ4lfaggNjQnrtU5/dS+kuiw3YuLV1JRxVHTOJHQ3W6cIvVRR92HKlkxrvzrhCJhy9oE/2+o5wcDkgaSVRKs/WZPO2R9lVQQr/KD8zcqsDopauFHg1cR/5oOUqXqry50fCm4QxrrL/dEbehJoiSTAeOGvVLmhmrY1oQ+1k5jRNSdN/38cRTsnV4lh4K+AFchJO25AflJtosyiaKneSsCGv8JDj9YXFxIA8MaMs4m/BAA6U/M8JY67IpEZeNyfdSvVZJrBs1Jf2VY5iI4zsOCBw3usXEB9n71XS976zbkekB4/zBBne/DhtKPeIx1W5+DY20iNlLMLZT4A5aEpgNou1pcK08i7AWxIA6KGrMHBc8pIZ0KoTHCWYOv9h4eKil2+u+HzOnqP7NlLIkg6skQku9W3zMwM0x047kMjM9ZEXhdKxpEgF2q8YzCEwlsgh0L8/0nETcWgbSlbwybqpiaPD7bSvHTQqnvrugJveHIB8T8blA+tkbQqg9MaybI9zKqxJyZTk=
    - secure: BE/HYDEpumoCVxW2iUQxz8o7G1g21UKiNkkSh9Y6jYIgckJsVFpHJSAQcCvrj/ivAa6IjMlJ2i3vkuPTuklYwHcargl4hKs/cEPwL0gHNL3w42a+F1lL5NZkGi2+8A7A7wqDbyDvCTACIKHYdjhKmPtblSRECZDYlt66UTvzXAPiil3Df3Myg+ViTBiqzTBl5EsIWdCFd+0CUp6aknjubLnV0QeaWDPIL5FHVctzNOctoydIbjakH7bIreNOKzkBKjdAOt2xwU52FvVY7udN3Q11gya4zB3GDdWGbTOC8vCyuKhjJTmZx1kJb8mIDyj3r0TvpdfhHvA7IrvxoMoXy8LXCC0Ofydrxw1QphsV1BEwEfSCqvhos/upmvXX8RvrNNpjjJ02tyKAZ2gWuPUl7XG6/xVV1zaToJPNyRsHVa333Rmf7dSbAABjHLCRlyANADwcL7Ngr/95HDMK0N0qluzQPFqLWuBxZApYevGVAeHUYDGQPFEzgxuRmGKWnTWH5En8v6ZT3WywmqxM76glhKZxWyx7M7FD5Y3lGBKaiwo2NjB8Fr+VK7YKz7D24Z+/QceZ/+Khyt/J2oSV4OHHMIuWWFvLsijcvZiaxC/rSDicYj/jufRXH49XP1SxaF2xPgYV0OPHdl0X580AgR8B70UuvcJbA94H1TPuafwBDbE=
    - secure: ZC587EBsZLLY8+upoHoKe9oV8L382aRUePCfsMWo0o+XgpciLXFvQ0lCGYrnsWeZvu0OMd3mLicj9kv/zHIpV59qzjGVFRl258bomrjxsZSmSoB+EvtZhOvz1NbniI27+YX8B8D0ttpzlnuT3RpdErbOPQAXGJgqqQVBQ5NhMahuj8KkoympNYAXJRcV67NUCRSr5JM67uIvF4AeNR/T6i1q+JkxZ24ftNGncASLS8lQpLdSP8pzyc20g4oCSWuaDgiAPY5n/b0/R+o02NBHXERhGd+9cXpgyalEwhWO2ay40Uttq5Ph33SuzEndUq4rx7dqs+ySCIuU3Ctxq1w2taKAl5+B3gK7Sll3l9HpsHl9elYtWNvaJFkPmHPggbPygnuWDrhvFCtVcsGffrcusEAzz+NSvp802+pk34xtUvH7/0X/o2TP9L5eVhxjxv9XIbOvRdDOFe/Q1Gdt6LmMRUdV5nbeFoJxNErAaHMDPEUUpXvmsE9DSFy2lefinAFcDdmb+dg+mDx9F56dOinil1puxZe2o2KKjrIlyo70cv6+5Vg8MvMS8hdrsTK1Ueb3M3TvcIgf764p7gY/0PSYP5qxLBCe5cRNt8d21qXH5cZMYzy2bEjYQIzTUgraIN/p6ZslE6Z/FeRkLMGNtDUTNzpH7XOmwwjtCMZguFJiD3A=
    - secure: mPI15Vl3FBBQCpKV0T1Rm4dekWgRobx+xT+JNhlLBNJWobPLxXAtxG7tfNc8qHYbPgs0UaPf8pCaV8xGGF2Dg0aDHxgdhhwVKhSiRtD7q8yEDitVm/HSFTUwwvKh35TsEPIC80cALyMXMHSyLSyORxFkWsXWIR5hEqREtf+6UFYtg1eNe/ORg/54hEIFL4shLX1a3HhfFukA0An7eee83YoXV4fReEAjBSHfd6CkrvbbLs56JuJ5fqSYpoA8r2VoZuunZsxQKC8Mk3586WJ9Jrf02KQG3rrndBbU51H15KpRM9asZF+h9L+SpU16Z1vyWfEzDWnbv/IjH6pFBsJSC6rfsgn8gcrmJzBkUOBCywVNGhqp0yMWicQNLsgddq/4Hr+8oes5itWDinDhJBZAbdjL5dsLpmLd0bHrz07OlcHT8lZYWjfCeSvUR+Ct+M+HmCsuTYNrq0kBlbIV9ZTlrobNb6UUdjYcFmP38CXeniE0lBa9vnns6tH76yisWlo3AL5deYPhl4UY2rZ2vUDt09JGnXixyt3pRCZaWp3M4HQPvHakM+b6Ygia5k4tT3Iom1wAVAIPfphZzLnAaHxeQpx9iRLNe17fq8mw8Oj6ANu4f8yY/AJ4qjhLQ0jKu/JndpRsMQ/xJYdUoYkgjKMithcL7SY0WNZ1dmyBPnnWVOE=
    - secure: hkrJxfUezZl+34PHy9UujlqQV8uGDIsnSolwPJFcwER6gwj+aI7koRQoDolIlhpC6yh7zH3FFBuZs2vkQcqGQUg4CsGsXRT+vv2Yq5t8Vj3H0THEM/U39Jqi5xJ3kDKL6phg7FdhAG41o+mzhpdawazh+9D8UeL8Ck3ROQCLVjD820ona9yRkjtkMvvk/MTA1baaIxepaoVAlAZN5cTCIFaypVBn9e8rHqRU5/V/78wbbbT1OhHHiemLKZ1DxNkM073G7/xhj8BDbCRIi49hJwWYKKebrsxXpwCc25amcDBb+3SaFk4KK7DqVC+M4aJI4/C9FYVPuWWqrSfRllDCpsv4husKdZ6kVoI6FZIY+W7uf6+3U9lKFZHCx2jdCgXGqbw/NL1gMNMG+7/x4+07BzN/1QYcDbRdNRhfMG18FqBic7jHjNU8cKZqOhOhQX8t6MawKlPefThkcTxifAxVdzAzv71RK1OWNZ2uJGAoHZaDh05BjfpDllJu+k+gv76+Pqw2pRUF5YCQdphjzPVdGFCoE5ho7NVuJuCMbugCeXXwoS1RVs4pGpolCRdFsmNhu5+o+wXkQVXMxgUEwVmy4etLfHfcmuoC5/zrYOJlI8yQei4KKY55TboD70EswrSguysRoyg3qP1pul57TgLP3m6JkGxBuv6WHXuvYnP6Sbs=
install:
- git submodule update --init
- go mod download
before_script:
- go vet ./...
- go build ./...
- go test -run xxxx ./...
script:
- make test-ci
after_success:
- bash <(curl -s https://codecov.io/bash)
before_deploy:
- make release
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: i1yCqHh8mIarJJx0hpxvR2DJkUTcHZyM+t1qETZq0Mep/CG2rFaw673PR7ZzJsO8SSVUaXBIZzNeTYdn1C+4+9AD9Isw7Ey7jrkPJLSgJciKuGtUIHWqbi+tO15l8RrJiDyRwHdAvhjW3DAw2F9mfu76UDLC+fRdz5oy/EPHObyUm4Zz9+2FACd61pWszzuxvFQTdL9vUZDlVHW60sYifWQoEBKlQNyO131M7TEbUI9y6Pyldw2e1JSYYvZ+VK2yxnTKph/wOz2omvfdqAq4vgyqtUPv3/G/ry6tUz2PrRj2Q410LHezV/zCV8cUoAGWgrjkCKwhekf1AovoGJhyMgqx+ZXSpVHrB3+ZTaUo8+X1UIjOw4Xc2ZCwah1pPEjn3rDEbNX+torCOByu8AGPV4R/CGu3E9nCGBCyrWOyQPfgteFIEo60hYs186cQxHAmUBlQQ5fudmCBuF3NF5YJ5viLrWsXFWt3WLoQ+Unmri7G34F0+K0ueCCQ+jbPGe1xuZmdtzKaQKGwi5bdy47n+khVt4Iu4sI/DW1iOXQKPa+jhwqGbuZNnSgl/tdL9kluxB5m/h4/etsD3l9bfPsyz8AJWOnynWakAry8TrG1CbwBdIEgROfFr2QrtJNx2RcW9byKt1qhpUJCJmYI3aDNxMm2HQrKroOd/G4cKXtuORg=
  file_glob: true
  file: release/*
  on:
    tags: true
    repo: bonedaddy/circuit-breaker
cache:
  directories:
  - "$GOPATH/pkg/mod"
  - "$HOME/.cache/go-build"
notifications:
  email: false